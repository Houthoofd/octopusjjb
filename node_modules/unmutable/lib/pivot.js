'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _prep = require('./internal/prep');

var _prep2 = _interopRequireDefault(_prep);

var _pipeWith = require('./util/pipeWith');

var _pipeWith2 = _interopRequireDefault(_pipeWith);

var _clear = require('./clear');

var _clear2 = _interopRequireDefault(_clear);

var _first = require('./first');

var _first2 = _interopRequireDefault(_first);

var _reduce = require('./reduce');

var _reduce2 = _interopRequireDefault(_reduce);

var _set = require('./set');

var _set2 = _interopRequireDefault(_set);

var _update = require('./update');

var _update2 = _interopRequireDefault(_update);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = (0, _prep2.default)({
    name: 'pivot',
    all: function all() {
        return function (value) {

            var outerContainer = (0, _pipeWith2.default)(value, (0, _clear2.default)());

            var innerContainer = (0, _pipeWith2.default)(value, (0, _first2.default)(), (0, _clear2.default)());

            return (0, _pipeWith2.default)(value, (0, _reduce2.default)(function (pivoted, outerValue, outerKey) {
                return (0, _pipeWith2.default)(outerValue, (0, _reduce2.default)(function (pp, value, innerKey) {
                    return (0, _pipeWith2.default)(pp, (0, _update2.default)(innerKey, outerContainer, (0, _set2.default)(outerKey, value)));
                }, pivoted));
            }, innerContainer));
        };
    }
});