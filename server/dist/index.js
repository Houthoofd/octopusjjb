var e=require("express"),o=require("cookie-parser"),r=require("morgan"),s=require("cors"),n=require("path"),t=require("mysql");function u(e){return e&&e.__esModule?e.default:e}const c=u(e).Router();c.get("/",function(e,o,r){o.send({layer:"users",version:1})});const l=u(e).Router();l.get("/",function(e,o,r){o.send({layer:"api",version:1})});class i{connection;constructor(){this.connection=u(t).createConnection({host:"localhost",user:"root",password:"",database:"octopus_jjb"}),this.connection.connect(e=>{if(e){console.error("Erreur de connexion à la base de données : "+e.stack);return}console.log("Connecté à la base de données MySQL avec l'ID : "+this.connection.threadId)})}query(e,o,r){this.connection.query(e,o,(e,o,s)=>{r(e,o,s)})}close(){this.connection.end(e=>{if(e){console.error("Erreur lors de la fermeture de la connexion : "+e.stack);return}console.log("Connexion à la base de données MySQL fermée")})}}class a{VerificationUtilisateur(e,o){return new Promise((r,s)=>{let n=new i;console.log("éxécution du query"),console.log(e,o),n.query(e,o,(e,o)=>{e?(console.error("Erreur lors de l'exécution de la requête : "+e.message),s(e)):(console.log("Résultats de la requête :",o),r(o)),n.close()})})}Insert(e,o){return new Promise((r,s)=>{let n=new i;console.log("éxécution du query Insert"),n.query(e,o,(e,o)=>{e?(console.error("Erreur lors de l'exécution de la requête : "+e.message),s(e)):(console.log("Résultats de la requête :",o),r(o)),n.close()})})}query(e,o){return new Promise((r,s)=>{let n=new i;console.log("éxécution du query"),n.query(e,o,(e,o)=>{e?(console.error("Erreur lors de l'exécution de la requête : "+e.message),s(e)):(console.log("Résultats de la requête :",o),r(o)),n.close()})})}}const d=u(e).Router();d.post("/",(e,o)=>{let{email:r,password:s}=e.body;new a().query("SELECT * FROM utilisateurs WHERE email = ? AND password = ?",[r,s]).then(e=>{e.length>0?o.json(e):o.status(401).send("Utilisateur non trouvé ou mot de passe incorrect")}).catch(e=>{console.error("Erreur lors de la vérification de l'utilisateur",e),o.status(500).send("Erreur lors de la vérification de l'utilisateur")})});const q=u(e).Router();q.get("/",(e,o)=>{new a().query("SELECT * FROM cours WHERE date_cours >= CURDATE() LIMIT 12").then(e=>{e.length>0?o.json(e):o.status(401).send("Cours non trouvés")}).catch(e=>{console.error("Erreur lors du chargement des cours",e),o.status(500).send("Erreur lors du chargement des cours")})});const g=u(e).Router();g.post("/",(e,o)=>{o.send({message:"ljflzeg"})});const E=u(e).Router();E.use("/users",c),E.use("/api",l),E.use("/connexion",d),E.use("/cours",q),E.use("/inscriptions",g);const h=process.cwd?process.cwd():process.env.PWD,p=u(e)();p.use(u(r)("dev")),p.use(u(e).json()),p.use(u(e).urlencoded({extended:!1})),p.use(u(o)()),p.use(u(e).static(u(n).join(h,"/server/public"))),p.use(u(s)()),p.use("/",E),p.listen(3e3);
//# sourceMappingURL=index.js.map
